<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DangThanhDuy_ps22256_Bán_hàng</title>
    <style>
        body {
            background-color: rgb(227, 173, 97);
        }

        .container {
            width: 700px;
            margin: auto;

        }

        #mucgia {
            padding: 5px 0;
            width: 150px;
            text-align: center;

        }

        #table_SP {
            width: 100%;
            padding: 20px;
            background: rgb(245, 189, 150);
            font-size: 20px;
        }

        #table_SP tr {
            background: rgb(172, 194, 201);
        }

        #table_SP td,
        th {
            padding: 8px 0;
            text-align: center;
        }

        #table_SP .soluong {
            width: 90px;
            text-align: center;
            padding: 4px;
        }

        #table_SP tr:first-child {
            background: wheat;
        }

        #table_SP .tong {
            color: red;
        }

        h2 {
            color: royalblue;
            text-align: center;
        }
    </style>
</head>

<body>

    <div class="container">
        <h2>Bán Hàng</h2>
        <select name="" id="mucgia" onchange="doimucgia()">
            <option value="-1">Chọn mức giá</option>
            <option value="200">Đến 200</option>
            <option value="400">Đến 400</option>
            <option value="600">Đến 600</option>
            <option value="800">Đến 800</option>
        </select>
        <table border="1" id="table_SP">
            <tr>
                <th colspan="2">Hàng hóa</th>
                <th>Dơn Giá</th>
                <th>Số lượng</th>
                <th>Thành viên</th>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(0)" name="chon" type="checkbox"></td>
                <td>Iphone 1</td>
                <td name="gia">500</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(1)" name="chon" type="checkbox"></td>
                <td>Iphone 2</td>
                <td name="gia">600</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(2)" name="chon" type="checkbox"></td>
                <td>Iphone 3</td>
                <td name="gia">100</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(3)" name="chon" type="checkbox"></td>
                <td>Iphone 4</td>
                <td name="gia">500</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(4)" name="chon" type="checkbox"></td>
                <td>Iphone 5</td>
                <td name="gia">600</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(5)" name="chon" type="checkbox"></td>
                <td>Iphone 6</td>
                <td name="gia">500</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(6)" name="chon" type="checkbox"></td>
                <td>Iphone 7</td>
                <td name="gia">200</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(7)" name="chon" type="checkbox"></td>
                <td>Iphone 8</td>
                <td name="gia">700</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(8)" name="chon" type="checkbox"></td>
                <td>Iphone 9</td>
                <td name="gia">400</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(9)" name="chon" type="checkbox"></td>
                <td>Iphone 10</td>
                <td name="gia">300</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr>
                <td><input onclick="tich1checkbox(10)" name="chon" type="checkbox"></td>
                <td>Iphone 11</td>
                <td name="gia">200</td>
                <td><input value="0" onkeyup="thanhtien(this)" class="soluong" name="soluong" disabled></td>
                <td name="thanhtien"></td>
            </tr>
            <tr class="tong">
                <th colspan="4">Tổng</th>
                <td id="tinhtong"><b>0</b></td>
            </tr>


        </table>
    </div>
</body>

</html>
<script>
    // tạo hàm doimucgia();
    function doimucgia() {
        // khai báo biến arrGia gán bằng giá trị giá trên html
        var arrGia = document.getElementsByName("gia");
        //ojb bằng mucgia
        var obj = document.getElementById("mucgia");
        // gán mức đang chọn bằng obj.value để lấy hết các giá trị của value
        mucdangchon = obj.value;
        //tạo vòng lặp duyệt mảng arrGia 
        for (i = 0; i < arrGia.length; i++) {
            //gán giá và chuyển kiểu dữ liệu của arrGia thứ i thành kiểu số
            gia = parseFloat(arrGia[i].innerText);
            //cho điều kiện giá phải nhỏ hơn mức đang chọn hoặc ==-1 thì chạy
            if (gia < mucdangchon || mucdangchon == -1) {
                //hiện tất cả các giá trị đúng để hiện còn sai thì ẩn
                arrGia[i].parentNode.style.display = "";
            } else {
                arrGia[i].parentNode.style.display = "none";
            }
        }
        //gọi hàm tongtien ở đây để mỗi khi đổi giá trị thì tính lại tiền
        tongtien();
    }



    // tạo hàm tich1checkbox tham số chuyền vào là i
    function tich1checkbox(i) {
        //gán arrSl bằng số lượng ở html
        var arrSL = document.getElementsByName("soluong");
        //khi người dùng click chọn thì mở disabled thành flase
        arrSL[i].disabled = !arrSL[i].disabled;


        // bổ sung để khi bỏ tích thì giá trị về 0
        if (arrSL[i].disabled == true) {
            arrSL[i].value = 0;
            //nếu đóng disabled thì cho giá trị ở trước số lượng là thành tiền vồ ""
            arrSL[i].parentNode.nextElementSibling.innerText = "";
        }
        //gọi lại hàm tongtien để tính
        tongtien();
    }


    //hàm thanhtien(); có tham số chuyền vào
    function thanhtien(obj) {
        var soluong = obj.value;

        // hàm truy xuất previousE.. lấy phía trên và innerText để lấy số
        // ngược lại sử dụng next.... để lấy phía sau
        var gia = obj.parentNode.previousElementSibling.innerText;
        obj.parentNode.nextElementSibling.innerText = soluong * gia;
        //gọi lại hàm tổng tiền
        tongtien();
    }


    // hàm tổng tiền
    function tongtien() {
        //khai báo biến tt cho = 0
        tt = 0;
        // gán arrThanhTien = #thanhtien ở html
        var arrThanhTien = document.getElementsByName("thanhtien");
        // sử dụng vòng forr để lấy hết các giá trị #thanhtien
        for (i = 0; i < arrThanhTien.length; i++) {
            if (arrThanhTien[i].parentNode.style.display == "") {
                tien = arrThanhTien[i].innerText;
                tt += Number(tien);
            }
        }
        //sử dụng new Intl.NumberFormat() để cho giá trị dễ nhìn
        var nf = new Intl.NumberFormat();
        document.getElementById("tinhtong").innerText = nf.format(tt);
    }


</script>